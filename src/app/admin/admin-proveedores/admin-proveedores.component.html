<div class="proveedores-container">
  <!-- Header de página -->
  <div class="page-header page-header-with-actions">
    <div class="header-content">
      <div class="title-section">
        <h2 class="header-left">
          Gestión de Proveedores
        </h2>
      </div>
      <div class="action-section">
        <button
          class="btn-primario"
          (click)="nuevoProveedor()"
          [disabled]="cargando"
        >
          <i class="fas fa-plus"></i>
          Nuevo Proveedor
        </button>
      </div>
    </div>
  </div>

  <!-- Indicador de carga -->
  <div *ngIf="cargando" class="loading-container">
    <i class="fas fa-spinner fa-spin"></i>
    Cargando proveedores...
  </div>

  <!-- Componente de búsqueda y filtro -->
  <app-table-search-filter
    [config]="searchFilterConfig"
    [totalItems]="proveedores.length"
    [filteredItems]="proveedoresFiltrados.length"
    [loading]="cargando"
    (searchChange)="onSearchFilterChange($event)"
    (clearFilters)="onClearFilters()"
  ></app-table-search-filter>

  <!-- Formulario Modal -->
  <div *ngIf="mostrarFormulario" class="modal-overlay">
    <div class="modal-proveedor">
      <div class="modal-content">
        <div class="modal-header">
          <h3>
            <i class="fas fa-{{ editando ? 'edit' : 'plus' }}"></i>
            {{ editando ? 'Editar' : 'Nuevo' }} Proveedor
          </h3>
        </div>

        <div class="modal-body">
          <form (ngSubmit)="guardarProveedor()" #form="ngForm">
            <div class="form-row">
              <div class="form-group">
                <label for="nombre">Nombre *</label>
                <input
                  id="nombre"
                  [(ngModel)]="formulario.nombre"
                  name="nombre"
                  placeholder="Nombre del proveedor"
                  required
                  maxlength="100"
                />
              </div>

              <div class="form-group">
                <label for="correo">Correo Electrónico *</label>
                <input
                  id="correo"
                  [(ngModel)]="formulario.correo"
                  name="correo"
                  type="email"
                  placeholder="correo@proveedor.com"
                  required
                />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="telefono">Teléfono *</label>
                <input
                  id="telefono"
                  [(ngModel)]="formulario.telefono"
                  name="telefono"
                  placeholder="+1234567890"
                  required
                />
              </div>

              <div class="form-group">
                <label for="pais">País</label>
                <input
                  id="pais"
                  [(ngModel)]="formulario.pais"
                  name="pais"
                  placeholder="País del proveedor"
                />
              </div>
            </div>

            <div class="form-group">
              <label for="direccion">Dirección</label>
              <textarea
                id="direccion"
                [(ngModel)]="formulario.direccion"
                name="direccion"
                placeholder="Dirección completa del proveedor"
                rows="3"
              ></textarea>
            </div>

            <div class="form-group">
              <label class="checkbox-container">
                <input
                  type="checkbox"
                  [(ngModel)]="formulario.activo"
                  name="activo"
                />
                <span class="checkmark"></span>
                Proveedor Activo
              </label>
              <div class="form-help">
                Los proveedores inactivos no aparecerán en las listas de selección
              </div>
            </div>
          </form>
        </div>

        <div class="modal-actions">
          <button
            type="button"
            class="btn-cancelar"
            (click)="cancelar()"
            [disabled]="cargando"
          >
            <i class="fas fa-times"></i>
            Cancelar
          </button>
          <button
            type="submit"
            class="btn-primario"
            (click)="guardarProveedor()"
            [disabled]="cargando"
          >
            <i class="fas fa-{{ cargando ? 'spinner fa-spin' : 'save' }}"></i>
            {{ editando ? 'Actualizar' : 'Guardar' }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Tabla de proveedores -->
  <div *ngIf="!cargando" class="tabla-container">
    <table class="tabla-moderna">
      <thead>
        <tr>
            <th>Nombre</th>
            <th>Correo</th>
            <th>Teléfono</th>
            <th>País</th>
            <th>Estado</th>
            <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let proveedor of proveedoresFiltrados"
            [class.row-inactive]="!proveedor.activo">
          <td>{{ proveedor.nombre }}</td>
          <td>{{ proveedor.correo }}</td>
          <td>{{ proveedor.telefono }}</td>
          <td>{{ proveedor.pais || '—' }}</td>
          <td>
            <span class="estado-badge"
                  [class.activo]="proveedor.activo"
                  [class.inactivo]="!proveedor.activo">
              <i class="fas fa-{{ proveedor.activo ? 'check-circle' : 'pause-circle' }}"></i>
              {{ proveedor.activo ? 'Activo' : 'Inactivo' }}
            </span>
          </td>
          <td>
            <div class="acciones-container">
              <button
                class="btn btn-edit"
                (click)="editar(proveedor)"
                [disabled]="cargando"
                title="Editar proveedor"
              >
                <i class="fas fa-edit"></i>
              </button>
              <button
                class="btn btn-danger"
                (click)="eliminar(proveedor.id)"
                [disabled]="cargando"
                title="Eliminar proveedor"
              >
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Estado vacío -->
    <div *ngIf="proveedoresFiltrados.length === 0 && proveedores.length > 0" class="no-results">
      <div class="no-results-icon">
        <i class="fas fa-search"></i>
      </div>
      <h3>Sin resultados</h3>
      <p>No se encontraron proveedores que coincidan con los filtros aplicados</p>
    </div>

    <div *ngIf="proveedores.length === 0" class="empty-state">
      <div class="empty-icon">
        <i class="fas fa-building"></i>
      </div>
      <h3>No hay proveedores registrados</h3>
      <p>Comience agregando el primer proveedor para gestionar sus productos y compras</p>
      <button class="btn-primario" (click)="nuevoProveedor()">
        <i class="fas fa-plus"></i>
        Agregar Primer Proveedor
      </button>
    </div>
  </div>
</div>
